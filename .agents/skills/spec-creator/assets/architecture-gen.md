# Architecture File Generator (Spec) — 精简强化版（修订）

## 0) 生成目标（不可变）

* 输出文件：`./docs/global/architecture.md`
* 格式：Markdown
* 语言：中文
* 核心目的：
  **强约束 AI 的代码生成行为，使其严格遵守分层、依赖方向与代码落点规则**
* 禁止讨论：

  * 具体框架
  * 具体库
  * 具体实现代码
* 允许讨论：

  * 架构形态
  * 分层职责
  * 依赖边界
  * 文件与目录落点规则

---

## 0.1 前置依赖（强制）

* `docs/global/vision.md`

### 流程（不可跳过）

1. 读取并理解 `vision.md`
2. 若缺失 → **只允许输出以下内容**：

```
缺少依赖 [docs/global/vision.md]
回复「Y」开始创建依赖。
```

3. 若存在 → 继续后续流程

---

## 1) 启动语（固定，不可修改）

> 现在开始创建项目架构（Architecture）。
> 我会一步一步问你问题，你只需要按问题回答即可。
> 在开始前，我会先读取并提炼 vision.md 作为上下文依据。

---

## Q1. 技术栈选择（Primary Framework）

> ⚠️ 本题用于确定本项目的**主框架**，以约束 AI 后续产出一致性。
> 只允许给出 **1–2 个“单一主框架”**备选；**禁止组合方案**（例如“X + Y”）。

### 系统建议（一次性给出）

基于 `vision.md` 判定交付形态后，系统给出 1–2 个主框架备选，并对每个备选用 **2–4 句**说明：

* 适合点（为什么匹配目标/迭代速度/风险）
* 代价点（会带来什么约束或复杂度）
* 适用边界（本项目哪些范围用它）

输出格式（固定）：

**方案 A：主框架 = <框架名>**

* 优点：…
* 缺点：…
* 适用边界：…

**方案 B：主框架 = <框架名>（可选）**

* 优点：…
* 缺点：…
* 适用边界：…

### 用户选择（只需回答一个字母）

> 请选择主框架：A / B
> 或：C) 我自行指定（写：交付形态 + 框架名）

---

## Q2. 分层模型（Layers）— 建议结构（核心参考）

> ⚠️ 本题用于为本项目提供**推荐的分层模型**，
> 作为后续依赖规则与代码落点的基础参考。

### Step 1：系统生成分层建议（必须）

系统需基于以下依据动态生成分层模型：

* Q1 选择的主技术框架
* `vision.md` 描述的产品目标与复杂度
* 当前阶段对可维护性与演进速度的需求

系统将给出一组**推荐的分层结构**，用于说明各层的职责边界与协作关系。

**以下为一组示例分层（仅作为范例）：**

* Adapter：对接并隔离外部系统，作为内部调用的统一入口
* Core：提供与业务无关的基础能力或通用功能
* Service：承载主要业务流程与状态规则
* ComponentLogic：负责组件层面的逻辑与状态组织，不涉及展示
* ComponentView：负责组件的展示与交互呈现
* Component：组合逻辑与展示形成可复用组件单元

> 实际分层名称、数量与职责可根据项目需求进行调整，但应保持职责单一与依赖清晰。

---

### Step 2：用户确认

> 对这份「分层模型建议」：
> A) 接受作为当前项目的分层参考
> B) 调整（可修改层级名称、职责描述或合并/拆分层）

---

## Q3. 依赖方向（Dependency Rules）— 强制规则

### Step 1：系统生成依赖规则（必须）

系统必须明确列出 **至少 6 条规则**，包括但不限于：

* 依赖只能**单向向下**
* Adapter 不依赖任何内部层
* Core 永远不知道 Service 的存在
* CpmtMeet 不得包含任何逻辑判断
* Component 不得跨层调用

规则语气必须为：
**“必须 / 禁止 / 永远不允许”**

---

### Step 2：用户确认

> 对这份「依赖方向规则」：
> A) 接受
> B) 修改（请直接改文字）

---

## Q4. 目录与落点规则（Project Layout Rules）

> ⚠️ 本题必须结合：
>
> * 当前专案实际目录结构
> * Q1 选定的技术栈方向
> * Q3 分层模型

### Step 1：系统生成草案（必须）

系统需提供：

1. **建议的顶层目录结构**
2. **3–6 条落点规则**（某类代码只能出现在哪）

规则必须能让 AI 在生成代码时：

* 知道「该写在哪」
* 知道「绝对不能写在哪」

---

### Step 2：用户确认

> 对这份「目录与落点规则」：
> A) 接受
> B) 修改（请直接改）

---

## 最终输出结构（固定）

```md
# 项目架构（Architecture）

## 架构形态
## 技术栈选择
## 分层模型
## 依赖方向（强制规则）
## 目录与落点规则
```

---



















